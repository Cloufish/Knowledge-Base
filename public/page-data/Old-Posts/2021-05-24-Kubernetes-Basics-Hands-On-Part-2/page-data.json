{"componentChunkName":"component---node-modules-gatsby-theme-garden-src-templates-local-file-js","path":"/Old-Posts/2021-05-24-Kubernetes-Basics-Hands-On-Part-2","result":{"data":{"file":{"childMdx":{"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Basics of Kubernetes Part 2\",\n  \"date\": \"2021-05-24 06:46:00 +0100\",\n  \"categories\": [\"DevSecOps\", \"Kubernetes\"],\n  \"tags\": [\"devsecops\", \"kubernetes\", \"containers\"],\n  \"lang\": \"en\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h2\", {\n    \"id\": \"connecting-to-the-podapp\"\n  }, \"Connecting to the Pod/App.\"), mdx(\"p\", null, \"We know from previous blog-post, that because Pods are disappearing, redeployed all the time we can't directly connect to them via IP - these are changing constantly.\"), mdx(\"p\", null, \"We then discussed a topic of Networking \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Service Object\")), mdx(\"p\", null, \"The Service Object from the Host/front-end perspective, acts as a static IP address, where from the Pod's/back-end's perspective it acts as a Load Balancer, assigning the resources and with that also IPs dynamically.\"), mdx(\"p\", null, \"When we connect to the Pods through Service Object, we do that using \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"ClusterIP\"), \", but also \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"DNS name\"), \" assigned to this IP.\"), mdx(\"p\", null, \"The DNS names are then transmitted to the Front-end Pods/Host config files like \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"/etc/resolv.conf\"), \". Thus, every Pod knows how to resolve these addresses.\"), mdx(\"h3\", {\n    \"id\": \"communication-between-apps\"\n  }, \"Communication between Apps\"), mdx(\"p\", null, \"To better illustrate resolving DNS names between Apps:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"App2 Node wants to communicate with App1 Node\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"It then sends a query to \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Cluster DNS\"), \" server and asks - \\\"I want to communicate with app1.svc, give me app1.svc IP address\\\"\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"The ClusterDNS resolves this DNS name to a IP address and returns it to the App2 Node\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"With having the IP address of the App1 (His Service Network Object), the App2 sends a request to the App1 Service Network Object with their query to the App.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"The Network Objects then queries one of the Pods and returns the results back to the App2 Node\")), mdx(\"h3\", {\n    \"id\": \"communication-between-apppods-and-host-system-on-the-same-network\"\n  }, \"Communication between App/Pods and Host system on the same network.\"), mdx(\"p\", null, \"This doesn't involve ClusterDNS, instead, it uses a \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"NodePort\"), \".\"), mdx(\"p\", null, \"All the nodes running are having the same Open Port. So, the communication is as follows:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"From the Host Machine, we send request to any Node on that Port\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Then it is routed to the Pod's Service Network Object, and then to the one of the Pods behind the Service\")), mdx(\"h4\", {\n    \"id\": \"imperative-way-of-doing-it\"\n  }, \"Imperative way of doing it:\"), mdx(\"p\", null, \"With command:\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"kubectl expose pod <pod_name> --name=<chosen_service_name> --target-port=8080 --type=NodePort\")), mdx(\"p\", null, \"The port we specify above is \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"from the Pod's perspective\"), \", If we want to see the port that is mapped to our host machine, we can check it with command:\"), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"kubectl get svc\")), mdx(\"p\", null, \"And there you'll see your service with the service name you specified, with the mapped port.\"), mdx(\"p\", null, mdx(\"img\", {\n    parentName: \"p\",\n    \"src\": \"https://imgur.com/CH1Fck2.png\",\n    \"alt\": \"get-svc\"\n  })), mdx(\"h4\", {\n    \"id\": \"declarative-way-of-doing-it\"\n  }, \"Declarative way of doing it:\"), mdx(\"p\", null, \"Setting the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"type: NodePort\"), \" in the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"spec:\"), \" object\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-yml\"\n  }, \"apiVersion: v1\\nkind: Service\\nmetadata:\\n  name: ps-nodeport\\nspec:\\n  type: NodePort\\n  ports:\\n  - port: 80\\n    targetPort: 8080\\n    nodePort: 31111\\n    protocol: TCP\\n  selector:\\n    app: web\\n\\n\")), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"port: 80\"), \" - refers to the port App listens on \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"inside the cluster\")), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"targetPort: 8080\"), \" - refers the port App listens on \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"inside the container\")), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"targetPort: 31111\"), \" - refers to the port Nodes listens on for our Host machine.\"), mdx(\"h3\", {\n    \"id\": \"communication-between-apppods-and-host-system-over-the-internet\"\n  }, \"Communication between App/Pods and Host system over the Internet.\"), mdx(\"p\", null, \"It uses \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Load Balancer\"), \".\"), mdx(\"p\", null, \"The Load Balancer integrates with Cloud Load Balancers\"), mdx(\"p\", null, \"It doesn't require much configuration, only to specify \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"type: LoadBalancer\"), \" in the yaml file, withing \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"spec:\"), \" object\"), mdx(\"p\", null, \"Well... it does require one thing - That the cloud implements Load Balancing, but most of the cloud provide it!\"), mdx(\"h2\", {\n    \"id\": \"kubernetes-deployment\"\n  }, \"Kubernetes Deployment\"), mdx(\"p\", null, \"K8s Deployment Service provide us a way of interacting with the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"replica sets\"), \".\"), mdx(\"p\", null, \"Replica sets stores a meta-data of desired state. It also watches this desired state constantly and at the same time It does scaling and self-healing.\"), mdx(\"p\", null, \"So the Deployment Service is used mostly to update the meta-data to be stored in replica sets.\\nWith it, We can also do rollback of the Deployment Manifest\"), mdx(\"p\", null, \"When We declare in the Deployment Service Manifest that we want a smaller amount of replicas e.g. 3, but we had 6, then the 3 \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"replicas will become inactive, but not deleted\"), \". This is to make the possibility of \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"rollbacks\")), mdx(\"h3\", {\n    \"id\": \"writing-deployment-controller-manifest\"\n  }, \"Writing Deployment Controller Manifest\"), mdx(\"p\", null, \"In Earlier blog-post when we were deploying Guestbook, we used this one:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-yml\"\n  }, \"apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: mongo\\n  labels:\\n    app.kubernetes.io/name: mongo\\n    app.kubernetes.io/component: backend\\nspec:\\n  selector:\\n    matchLabels:\\n      app.kubernetes.io/name: mongo\\n      app.kubernetes.io/component: backend\\n  replicas: 1\\n  template:\\n    metadata:\\n      labels:\\n        app.kubernetes.io/name: mongo\\n        app.kubernetes.io/component: backend\\n    spec:\\n      containers:\\n      - name: mongo\\n        image: mongo:4.2\\n        args:\\n          - --bind_ip\\n          - 0.0.0.0\\n        resources:\\n          requests:\\n            cpu: 100m\\n            memory: 100Mi\\n        ports:\\n        - containerPort: 27017\\n\\n\")), mdx(\"p\", null, \"I don't think I'll be writing about the same thing again, sorry, it just seems unlogical to me.\"), mdx(\"p\", null, \"But let's add, that we can update this Manifest file and apply it with command:\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"kubectl apply -f deployment.yml\"), \"\\nAnd the replicas will update their data like desired state if necessary, without any drop of the services, so amazing!\"));\n}\n;\nMDXContent.isMDXComponent = true;","outboundReferences":[],"inboundReferences":[{"__typename":"Mdx","body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Old Posts From Previous Blog\",\n  \"tags\": \"moc, permanent-note\",\n  \"references\": null\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", {\n    \"id\": \"old-posts-from-previous-blog\"\n  }, \"Old Posts From Previous Blog\"), mdx(\"h2\", {\n    \"id\": \"blogging\"\n  }, \"Blogging\"), mdx(\"p\", null, \"\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/Why-You-Should-Start-Your-Own-Blog\",\n    \"title\": \"Why You Should Start Your Own Blog\"\n  }, \"[[Why You Should Start Your Own Blog]]\"), \"\\n\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/How-to-Create-Your-Own-Blog-With-Jekyll\",\n    \"title\": \"How to Create Your Own Blog With Jekyll\"\n  }, \"[[How to Create Your Own Blog With Jekyll]]\"), \"\"), mdx(\"h2\", {\n    \"id\": \"blackarch\"\n  }, \"Blackarch\"), mdx(\"p\", null, \"\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/2021-01-27-blackarch-zsh-en\",\n    \"title\": \"2021-01-27-blackarch-zsh-en\"\n  }, \"[[2021-01-27-blackarch-zsh-en]]\"), \"\\n\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/2021-05-30-blackarch-has-its-own-official-image.md\",\n    \"title\": \"2021-05-30-blackarch-has-its-own-official-image.md\"\n  }, \"[[2021-05-30-blackarch-has-its-own-official-image.md]]\"), \"\"), mdx(\"h2\", {\n    \"id\": \"note-taking\"\n  }, \"Note-Taking\"), mdx(\"p\", null, \"\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/2021-06-12-How-To-Take-Better-Notes\",\n    \"title\": \"2021-06-12-How-To-Take-Better-Notes\"\n  }, \"[[2021-06-12-How-To-Take-Better-Notes]]\"), \"\"), mdx(\"h2\", {\n    \"id\": \"others\"\n  }, \"Others:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"/2020-12-07-is-this-blog-dead-en\",\n    \"title\": \"2020-12-07-is-this-blog-dead-en\"\n  }, \"[[2020-12-07-is-this-blog-dead-en]]\"), \"\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"/2021-02-12-creating-your-own-docker-pentesting-container\",\n    \"title\": \"2021-02-12-creating-your-own-docker-pentesting-container\"\n  }, \"[[2021-02-12-creating-your-own-docker-pentesting-container]]\"), \"\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"/2021-03-02-Preparing-your-PHYSICAL-android-device-for-bug-bounty-part-1\",\n    \"title\": \"2021-03-02-Preparing-your-PHYSICAL-android-device-for-bug-bounty-part-1\"\n  }, \"[[2021-03-02-Preparing-your-PHYSICAL-android-device-for-bug-bounty-part-1]]\"), \"\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"/2021-03-02-Why-should-you-root-your-own-android-device\",\n    \"title\": \"2021-03-02-Why-should-you-root-your-own-android-device\"\n  }, \"[[2021-03-02-Why-should-you-root-your-own-android-device]]\"), \"\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"/2021-03-21-OWASP-ZAP-as-a-great-fuzzing-tool\",\n    \"title\": \"2021-03-21-OWASP-ZAP-as-a-great-fuzzing-tool\"\n  }, \"[[2021-03-21-OWASP-ZAP-as-a-great-fuzzing-tool]]\"), \"\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"/2021-03-28-Can-OWASP-ZAP-replace-Burp-Suite-Professional\",\n    \"title\": \"2021-03-28-Can-OWASP-ZAP-replace-Burp-Suite-Professional?\"\n  }, \"[[2021-03-28-Can-OWASP-ZAP-replace-Burp-Suite-Professional?]]\"), \"\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"/2021-04-05-Learning-on-how-to-build-a-modern-webapp\",\n    \"title\": \"2021-04-05-Learning-on-how-to-build-a-modern-webapp\"\n  }, \"[[2021-04-05-Learning-on-how-to-build-a-modern-webapp]]\"), \"\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"/2021-04-12-Setting-up-zap-scan-in-cicd-pipeline\",\n    \"title\": \"2021-04-12-Setting-up-zap-scan-in-cicd-pipeline\"\n  }, \"[[2021-04-12-Setting-up-zap-scan-in-cicd-pipeline]]\"), \"\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"/2021-04-19-Setting-Up-Hashicorp-Vault-To-Manage-Github-Token\",\n    \"title\": \"2021-04-19-Setting-Up-Hashicorp-Vault-To-Manage-Github-Token\"\n  }, \"[[2021-04-19-Setting-Up-Hashicorp-Vault-To-Manage-Github-Token]]\"), \"\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"/2021-04-26-Preventing-Insufficient-Logging-and-Monitoring\",\n    \"title\": \"2021-04-26-Preventing-Insufficient-Logging-and-Monitoring\"\n  }, \"[[2021-04-26-Preventing-Insufficient-Logging-and-Monitoring]]\"), \"\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"/2021-05-03-Basics-Of-Kubernetes\",\n    \"title\": \"2021-05-03-Basics-Of-Kubernetes\"\n  }, \"[[2021-05-03-Basics-Of-Kubernetes]]\"), \"\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"/2021-05-10-Kubernetes-Basics-Hands-On\",\n    \"title\": \"2021-05-10-Kubernetes-Basics-Hands-On\"\n  }, \"[[2021-05-10-Kubernetes-Basics-Hands-On]]\"), \"\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"/2021-05-17-Security-Of-Docker-Containers\",\n    \"title\": \"2021-05-17-Security-Of-Docker-Containers\"\n  }, \"[[2021-05-17-Security-Of-Docker-Containers]]\"), \"\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"/2021-05-24-Kubernetes-Basics-Hands-On-Part-2\",\n    \"title\": \"2021-05-24-Kubernetes-Basics-Hands-On-Part-2\"\n  }, \"[[2021-05-24-Kubernetes-Basics-Hands-On-Part-2]]\"), \"\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\", mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"/2021-06-13-Making-Rules-For-IPTables-Firewall-With-UFW\",\n    \"title\": \"2021-06-13-Making-Rules-For-IPTables-Firewall-With-UFW\"\n  }, \"[[2021-06-13-Making-Rules-For-IPTables-Firewall-With-UFW]]\"), \"\")));\n}\n;\nMDXContent.isMDXComponent = true;","parent":{"__typename":"File","id":"1e197c1d-7688-55e9-8881-78b0077a5007","fields":{"slug":"/Old Posts From Previous Blog","title":"Old Posts From Previous Blog"}}}]},"fields":{"slug":"/Old-Posts/2021-05-24-Kubernetes-Basics-Hands-On-Part-2","title":"2021-05-24-Kubernetes-Basics-Hands-On-Part-2"}}},"pageContext":{"id":"301444bb-e6d2-5d4f-ad8f-3dbc397fb27b"}},"staticQueryHashes":["2098632890","2221750479","2468095761"]}